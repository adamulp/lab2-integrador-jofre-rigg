doctype html
html
  head
    title Calendario
    link(rel='stylesheet', href='https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css')
    link(rel='stylesheet', href='/styles/styles.css')
    script(src='https://code.jquery.com/jquery-3.6.0.min.js')
    script.
      $(document).ready(function() {
        let isMouseDown = false;

        // Highlight entire day column
        $('.day-header').click(function() {
          var index = $(this).index();
          var isHighlighted = $('.calendar-grid .row').first().children().eq(index).hasClass('highlighted');
          $('.calendar-grid .row').each(function() {
            if (isHighlighted) {
              $(this).children().eq(index).removeClass('highlighted');
            } else {
              $(this).children().eq(index).addClass('highlighted');
            }
          });
        });

        // Highlight entire hour-long row
        $('.hora-header').click(function() {
          var row = $(this).parent();
          if (row.children().not('.highlighted').length === 0) {
            row.children().removeClass('highlighted');
          } else {
            row.children().addClass('highlighted');
          }
        });

        // Contiguous grid highlighting
        $('.hora-col').mousedown(function() {
          isMouseDown = true;
          $(this).toggleClass('highlighted');
          return false; // prevent text selection
        }).mouseover(function() {
          if (isMouseDown) {
            $(this).toggleClass('highlighted');
          }
        });

        $(document).mouseup(function() {
          isMouseDown = false;
        });

        // Prevent selection of headers and first column
        $('.hora-header, .day-header').mousedown(function(event) {
          event.stopPropagation();
        });
      });
    style.
      .highlighted {
        background-color: lightblue !important;
      }
      .hora-header, .day-header {
        background-color: #f8f9fa !important;
        cursor: default;
        user-select: none;
      }
  body
    .container
      h1 Calendario de Citas
      form(action='/calendario', method='POST')
        .row
          .col-md-4
            .mb-3
              label(for='especialidad') Especialidad:
              select.form-select(name='especialidad' id='especialidad')
                option(value='') -- Seleccione Especialidad --
                each especialidad in especialidades
                  option(value=especialidad.nombre) #{especialidad.nombre}
          .col-md-4
            .mb-3
              label(for='medico') Médico:
              select.form-select(name='medico' id='medico')
                option(value='') -- Seleccione Médico --
                each medico in medicos
                  option(value=medico.nombreCompleto) #{medico.nombreCompleto}
          .col-md-4
            .mb-3
              label(for='paciente') Paciente:
              select.form-select(name='paciente' id='paciente')
                option(value='') -- Seleccione Paciente --
                each paciente in pacientes
                  option(value=paciente.nombreCompleto) #{paciente.nombreCompleto}
        button.btn.btn-primary(type='submit') Filtrar
      // Move buttons inside the container
      button#prevWeek.btn.btn-secondary.calendar-control ◀
      .calendar-grid
        .row
          .col.border.hora-header(style='background-color: #f8f9fa; cursor: default;') Hora
          each dia in ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado', 'Domingo']
            .col.border.day-header(style='background-color: #f8f9fa; cursor: pointer;') #{dia}
        .row
          .col.border(style='background-color: #f8f9fa; cursor: default;') Fecha
          each dia in ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado', 'Domingo']
            .col.border.date-header(style='background-color: #f8f9fa; cursor: default;')
        each hora in ['08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00']
          .row
            .col.border.hora-header(style='cursor: default;') #{hora}
            each dia in ['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado', 'Domingo']
              .col.border.hora-col(style='height: 50px; cursor: pointer;')
      button#nextWeek.btn.btn-secondary.calendar-control ▶
      